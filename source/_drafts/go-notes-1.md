---
title: Go 语言学习笔记（一）— Go 环境搭建
tags:
  - Go
id: '1121'
categories:
  - - something-about-daily-work
    - Go
---

## 背景知识

Go 语言的发明者有三个人：Rob Pike、Ken Thompson、Robert Griesemer，首次开源发布日期是2009 年 11 月 10 日。

Go 语言的核心特性：

*   开源
*   面向对象支持
*   静态类型
*   并发支持
*   强大的标准库和工具链
*   易于测试
*   垃圾回收

Go 语言能够快速流行的一些原因有：

*   语法简单，容易上手
*   跨平台
*   容易部署
*   编译速度快

## Go 环境的搭建

Go 语言的发展实在是太快了，我借阅和购买了一些关于 Go 的书籍，其内容和我在电脑上安装的主流版本基本上做不到完全匹配，也即，当一本书出版后，其内容就已经或多或少过时了，这不能不说是一个甜蜜的烦恼。

安装 Go 语言，是一个简单而快速的过程，直接参考官网的安装说明，在 Mac 上，使用 `brew` 来安装，是十分简单而且愉快的过程。

### GOROOT 环境变量

可能有些书上会要求设置 GOROOT 环境变量，不过，这是一个过时的变量。大概是 Go 1.0 以后的版本，就开始支持了 Go tool，所以，编译器很容易就可以自行推导 GOROOT 的值：

```shell
go env GOROOT
```

就可以看到 GOROOT 的值了。

### GOPATH 环境变量

这可能是学习 Go 语言时候遇到的最著名的环境变量了。至少，我手头的所有出版书籍，都会介绍这个环境变量。

Go Workspace 代表 Go 的工作空间，是 Go 管理源代码文件、编译好的二进制文件，以及缓存的编译对象以便于未来快速编译的处所。一般，建议一台服务器上，就只有一个工作空间比较好，当然，有多个工作空间也是可以的。**GOPATH 就是工作空间的根目录**。

```shell
.
├── bin
├── pkg
└── src
```

一般来说，我们的项目都会在 `src` 文件夹下面，当我们使用 `go get` 来下载一些模块的时候，代码也会放在 `src` 目录下，只有这样，编译器才能在编译的时候找到依赖的代码，说 GOPATH 是学习 Go 语言时候遇到的第一个最重要的环境变量也不为过。

当然，GOPATH 这种模式的缺点也是显而易见的，至少，作为一个 Web 开发者，我是很不习惯这样的，电脑上一般都会有很多的项目，每个项目有各自不同的依赖，所有的项目挤到一个工作空间，显然是非常不利于管理的。

好在，**GOPATH 也快退出历史舞台了**。至少在现在已经不是一个必然的选项了。在 Go 1.11 以后的版本，引入了 Go Modules，用于管理你的项目。

### Go Modules 和 GO111MODULE 环境变量

首先来说一下什么是 Module，模块，就是一个包含了很多 package 的目录。

我们写的项目，引用了很多的包，最后编译成一个可执行文件，这个结构也符合模块的定义要求。所以，可以用 Module 来管理项目。

一个目录被声明为一个模块后，目录下会创建一个 go.mod 文件来管理这个模块的依赖，这样我们就用不着 GOPATH 那种管理的方式了。以后一个模块的依赖由模块自己单独管理。但是，显然这种管理方式和 GOPATH 的管理方式，两种方式是不兼容的。所以就不得不用到了 GO111MODULE 环境变量。

这个变量有三个取值，`on` 、`off` 和 `auto`，当取值为 `off` 时，会完全摒弃使用模块来管理，退回到使用 GOPATH 管理的模式。如果设置为 `on` 则会把依赖的包放到 GOPATH 之外的地方单独管理。此时可以将项目放在 GOPATH 里面或外面都行。在 Go 1.13+ 版本后，可以将变量设置为 `auto`，使得当项目在 GOPATH 里面时候，包管理的行为类似设置为 `off`，而项目放在 GOPATH 外面的时候，包管理的行为类似设置为 `on`。做到了自适应。